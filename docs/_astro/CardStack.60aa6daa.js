import{r as c}from"./index.26f5e802.js";import{j as h}from"./jsx-runtime.47a19089.js";import{L as C,a as v,u as I,M as A,d as R,i as U,c as D,e as T,f as F,g as M,h as P,j as S,k as z,m as N}from"./use-force-update.df9cacee.js";const O=c.createContext(null),W=t=>!t.isLayoutDirty&&t.willUpdate(!1);function E(){const t=new Set,n=new WeakMap,s=()=>t.forEach(W);return{add:e=>{t.add(e),n.set(e,e.addEventListener("willUpdate",s))},remove:e=>{t.delete(e);const o=n.get(e);o&&(o(),n.delete(e)),s()},dirty:s}}const j=t=>t===!0,_=t=>j(t===!0)||t==="id",J=({children:t,id:n,inherit:s=!0})=>{const e=c.useContext(C),o=c.useContext(O),[a,r]=v(),u=c.useRef(null),i=e.id||o;u.current===null&&(_(s)&&i&&(n=n?i+"-"+n:i),u.current={id:n,group:j(s)&&e.group||E()});const m=c.useMemo(()=>({...u.current,forceRender:a}),[r]);return c.createElement(C.Provider,{value:m},t)};function x(t){const n=I(()=>R(t)),{isStatic:s}=c.useContext(A);if(s){const[,e]=c.useState(t);c.useEffect(()=>n.on("change",e),[])}return n}const q=t=>typeof t=="object"&&t.mix,B=t=>q(t)?t.mix:void 0;function H(...t){const n=!Array.isArray(t[0]),s=n?0:-1,e=t[0+s],o=t[1+s],a=t[2+s],r=t[3+s],u=U(o,a,{mixer:B(a[0]),...r});return n?u(e):u}function K(t,n){const s=x(n()),e=()=>s.set(n());return e(),D(()=>{const o=()=>F.update(e,!1,!0),a=t.map(r=>r.on("change",o));return()=>{a.forEach(r=>r()),T(e)}}),s}function V(t,n,s,e){const o=typeof n=="function"?n:H(n,s,e);return Array.isArray(t)?b(t,o):b([t],([a])=>o(a))}function b(t,n){const s=I(()=>[]);return K(t,()=>{s.length=0;const e=t.length;for(let o=0;o<e;o++)s[o]=t[o].get();return n(s)})}function L(t,n={}){const{isStatic:s}=c.useContext(A),e=c.useRef(null),o=x(M(t)?t.get():t),a=()=>{e.current&&e.current.stop()};return c.useInsertionEffect(()=>o.attach((r,u)=>{if(s)return u(r);if(a(),e.current=P({keyframes:[o.get(),r],velocity:o.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...n,onUpdate:u}),!S.isProcessing){const i=performance.now()-S.timestamp;i<30&&(e.current.time=z(i))}return o.get()},a),[JSON.stringify(n)]),D(()=>{if(M(t))return t.on("change",r=>o.set(parseFloat(r)))},[o]),o}const y={damping:15,stiffness:180,mass:.15};function Q(t){return 1-Math.pow(1-t,3)}function w(t,n,s){const e=Q(s);return t+(n-t)*e}function X({i:t,card:n,moveToEnd:s,xInput:e}){const o=c.useMemo(()=>20*t,[t]),a=c.useMemo(()=>1-t*.1,[t]),r=c.useMemo(()=>5-t,[t]),u=c.useMemo(()=>t*-2,[t]),i=V(e,f=>{const l=Math.min(Math.abs(f),200)/200,p=1-t*.1,d=p+.1,g=Math.min(l,1);return w(p,d,Math.pow(g,t))}),m=V(e,f=>{const l=Math.min(Math.abs(f),200)/200,p=t*-2,d=p+2,g=Math.min(l,1);return w(p,d,g)}),G=L(m,y),k=L(i,y);return h.jsx(N.li,{title:"Drag me",layout:!0,drag:t===0?"x":!1,dragSnapToOrigin:!0,className:"cursor-pointer",dragConstraints:{left:-100,right:0},onDrag:(f,l)=>{e.set(l.offset.x)},onDragEnd:(f,l)=>{e.set(0),l.offset.x<-100&&s()},whileDrag:{cursor:"grabbing"},style:{gridColumn:"1 / 4",gridRow:"1",scale:k,rotate:G,zIndex:r},animate:{x:o,zIndex:r,scale:a,rotate:u,transition:{type:"spring",...y}},children:n})}function tt({children:t}){const[n,s]=c.useState(c.Children.toArray(t)),e=x(0),o=()=>{s(a=>{const r=[...a],u=r.shift();return u&&r.push(u),r})};return h.jsx(J,{children:n.map((a,r)=>h.jsx(X,{i:r,card:a,moveToEnd:o,xInput:e},a.key))})}export{tt as C};
